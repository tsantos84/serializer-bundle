<?xml version="1.0" encoding="UTF-8"?>

<container xmlns="http://symfony.com/schema/dic/services"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <parameters>
        <parameter key="tsantos_serializer.debug" />
        <parameter key="tsantos_serializer.encoder_registry.class">TSantos\Serializer\EncoderRegistry</parameter>
        <parameter key="tsantos_serializer.json_encoder.class">TSantos\Serializer\Encoder\JsonEncoder</parameter>
        <parameter key="tsantos_serializer.normalizer_registry.class">TSantos\Serializer\NormalizerRegistry</parameter>
        <parameter key="tsantos_serializer.datetime_normalizer.class">TSantos\Serializer\Encoder\DateTimeNormalizer</parameter>
        <parameter key="tsantos_serializer.identity_normalizer.class">TSantos\Serializer\Encoder\IdentityNormalizer</parameter>
        <parameter key="tsantos_serializer.metadata_type_guesser.class">TSantos\Serializer\TypeGuesser</parameter>
        <parameter key="tsantos_serializer.metadata_file_locator.class">Metadata\Driver\FileLocator</parameter>
        <parameter key="tsantos_serializer.metadata_paths" type="collection" />
        <parameter key="tsantos_serializer.metadata_factory.class">Metadata\MetadataFactory</parameter>
        <parameter key="tsantos_serializer.metadata_chain_driver.class">Metadata\Driver\DriverChain</parameter>
        <parameter key="tsantos_serializer.metadata_xml_driver.class">TSantos\Serializer\Metadata\Driver\XmlDriver</parameter>
        <parameter key="tsantos_serializer.metadata_yaml_driver.class">TSantos\Serializer\Metadata\Driver\YamlDriver</parameter>
        <parameter key="tsantos_serializer.metadata_php_driver.class">TSantos\Serializer\Metadata\Driver\PhpDriver</parameter>
        <parameter key="tsantos_serializer.metadata_file_cache.class">Metadata\Cache\FileCache</parameter>
        <parameter key="tsantos_serializer.metadata_doctrine_cache.class">Metadata\Cache\DoctrineCacheAdapter</parameter>
        <parameter key="tsantos_serializer.metadata_psr_cache.class">Metadata\Cache\PsrCacheAdapter</parameter>
        <parameter key="tsantos_serializer.metadata_cache_warmer.class">TSantos\Bundle\Cache\CacheWarmer</parameter>
        <parameter key="tsantos_serializer.class_loader.class">TSantos\Serializer\SerializerClassLoader</parameter>
        <parameter key="tsantos_serializer.class_code_generator.class">TSantos\Serializer\SerializerClassCodeGenerator</parameter>
        <parameter key="tsantos_serializer.class_writer.class">TSantos\Serializer\SerializerClassWriter</parameter>
        <parameter key="tsantos_serializer.class_path" type="collection" />
        <parameter key="tsantos_serializer.class_generate_strategy" type="constant">TSantos\Serializer\SerializerClassLoader::AUTOGENERATE_FILE_NOT_EXISTS</parameter>
        <parameter key="tsantos_serializer.serializer.class">TSantos\Serializer\Serializer</parameter>
    </parameters>

    <services>
        <!-- encoders -->
        <service id="tsantos_serializer.encoder_registry" class="%tsantos_serializer.encoder_registry.class%" />
        <service id="tsantos_serializer.json_encoder" class="%tsantos_serializer.json_encoder.class%">
            <tag name="tsantos_serializer.encoder" />
        </service>

        <!-- normalizers -->
        <service id="tsantos_serializer.normalizer_registry" class="%tsantos_serializer.normalizer_registry.class%" />
        <service id="tsantos_serializer.datetime_encoder" class="%tsantos_serializer.json_encoder.class%">
            <tag name="tsantos_serializer.encoder" />
        </service>

        <!-- metadata -->
        <service id="tsantos_serializer.metadata_file_locator" class="%tsantos_serializer.metadata_file_locator.class%">
            <argument>%tsantos_serializer.metadata_paths%</argument>
        </service>
        <service id="tsantos_serializer.metadata_type_guesser" class="%tsantos_serializer.metadata_type_guesser.class%" />
        <service id="tsantos_serializer.metadata_chain_driver" class="%tsantos_serializer.metadata_chain_driver.class%" />
        <service id="tsantos_serializer.metadata_yaml_driver" class="%tsantos_serializer.metadata_yaml_driver.class%">
            <argument type="service" id="tsantos_serializer.metadata_file_locator" />
            <argument type="service" id="tsantos_serializer.metadata_type_guesser" />
            <tag name="tsantos_serializer.metadata_driver" />
        </service>
        <service id="tsantos_serializer.metadata_xml_driver" class="%tsantos_serializer.metadata_xml_driver.class%">
            <argument type="service" id="tsantos_serializer.metadata_file_locator" />
            <argument type="service" id="tsantos_serializer.metadata_type_guesser" />
            <tag name="tsantos_serializer.metadata_driver" />
        </service>
        <service id="tsantos_serializer.metadata_php_driver" class="%tsantos_serializer.metadata_php_driver.class%">
            <argument type="service" id="tsantos_serializer.metadata_file_locator" />
            <argument type="service" id="tsantos_serializer.metadata_type_guesser" />
            <tag name="tsantos_serializer.metadata_driver" />
        </service>
        <service id="tsantos_serializer.metadata_factory" class="%tsantos_serializer.metadata_factory.class%">
            <argument type="service" id="tsantos_serializer.metadata_chain_driver" />
            <argument type="string">Metadata\ClassHierarchyMetadata</argument>
            <argument>%tsantos_serializer.debug%</argument>
        </service>
        <service id="tsantos_serializer.metadata_file_cache" class="%tsantos_serializer.metadata_file_cache.class%">
            <argument />
        </service>
        <service id="tsantos_serializer.metadata_doctrine_cache" class="%tsantos_serializer.metadata_doctrine_cache.class%">
            <argument />
        </service>
        <service id="tsantos_serializer.metadata_psr_cache" class="%tsantos_serializer.metadata_psr_cache.class%">
            <argument />
        </service>
        <service id="tsantos_serializer.metadata_cache_warmer" class="%tsantos_serializer.metadata_cache_warmer.class%">
            <argument type="service" id="tsantos_serializer.metadata_factory" />
            <argument type="service" id="tsantos_serializer.class_code_generator" />
            <argument type="service" id="tsantos_serializer.class_writer" />
            <tag name="kernel.cache_warmer" />
        </service>

        <!-- serializer class manager -->
        <service id="tsantos_serializer.class_code_generator" class="%tsantos_serializer.class_code_generator.class%" />
        <service id="tsantos_serializer.class_writer" class="%tsantos_serializer.class_writer.class%">
            <argument>%tsantos_serializer.class_path%</argument>
        </service>
        <service id="tsantos_serializer.class_loader" class="%tsantos_serializer.class_loader.class%">
            <argument type="service" id="tsantos_serializer.metadata_factory" />
            <argument type="service" id="tsantos_serializer.class_code_generator" />
            <argument type="service" id="tsantos_serializer.class_writer" />
            <argument>%tsantos_serializer.class_generate_strategy%</argument>
        </service>

        <service id="tsantos_serializer" class="%tsantos_serializer.serializer.class%">
            <argument type="service" id="tsantos_serializer.class_loader"/>
            <argument type="service" id="tsantos_serializer.encoder_registry"/>
            <argument type="service" id="tsantos_serializer.normalizer_registry"/>
        </service>
        <service id="TSantos\Serializer\SerializerInterface" alias="tsantos_serializer" />
    </services>
</container>
